# PDI configuration
pdi:
  metadata:
    ii:     int
    generations: int 
    pcoord_1d:     int
    pcoord: { type: array, subtype: int, size: 2 }
    dsize:  { type: array, subtype: int, size: 2 }
    psize_1d: int 
    gmax: int 
  data:
    main_field: { type: array, subtype: double, size: [ '$dsize[0]-2', '$dsize[1]-2' ] }
  plugins:
    pycall:
      on_event:
        Initialization:
          with:
            generations_p: $generations
            pcoord_p: $pcoord
            pcoord_1d_p: $pcoord_1d
            psize_1d_p: $psize_1d
            gmax_p: $gmax
          exec: |
              from dask_interface import Init
              cpl = Init(psize_1d_p, pcoord_1d_p, pcoord_p, gmax_p)

        Available:
          with:
            ii_p: $ii
            main_field_p: $main_field
          exec: |
              cpl.publish_data( ii_p, main_field_p)                  
        Finalization:
          exec: |
            cpl.Finalize()
              
